# coding=utf-8
# uliontse
# python2

from __future__ import division ## must first row
import sys
import datetime
from pyspark import SparkContext,HiveContext


reload(sys)
sys.setdefaultencoding('utf-8')


try:
    sc = SparkContext()
    spark = HiveContext(sc)
except:
    spark = HiveContext(sc)

def getDate(n,isPt=True):
    today=datetime.date.today()
    oneday=datetime.timedelta(days=n)
    if isPt:
        return (today + oneday).strftime('%Y%m%d')
    return (today + oneday).strftime('%Y-%m-%d')



sql = '''
SELECT 
      student_id
	, pack_unit_score
	, pack_type_score
	, pack_renewal_cycle_score
	, incentive_sensitivity
FROM bigdata_algorithm.base_student
WHERE pt='{pt}'
'''.format(pt=getDate(-1))

df = spark.sql(sql).select('student_id','pack_unit_score','pack_type_score','pack_renewal_cycle_score','incentive_sensitivity')
pf = df.toPandas()
lists = pf.values.tolist()


#TODO
